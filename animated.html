<!DOCTYPE html>
<html>
<head>
<!-- Load the Paper.js library -->
<link rel="stylesheet" href="css/bootstrap.min.css">
<link rel="stylesheet" href="css/bootstrap-responsive.min.css">
<script type="text/javascript" src="js/paper.js"></script>
<script type="text/javascript" src="js/jquery.js"></script>
<!-- Library to implement the event: -->
<script type="text/javascript" src="js/smokesignals.js"></script>
<script type="text/javascript" src="js/animation.js"></script>
<script type="text/javascript" src="js/body.js"></script>
<script type="text/javascript" src="js/bootstrap.min.js"></script>
<script type="text/javascript" language="javascript">
    paper.install(window);
    

    var startAnim = function(){

        $('<canvas id="myCanvas"></canvas>').appendTo('body').attr('resize', 'true');
        paper.setup('myCanvas');

        var dj_pos = new Point( view.bounds.width * Math.random(), view.bounds.height * Math.random());

        paper.tool.onMouseUp = function(event) {
            var evPt = event.middlePoint;

            if(evPt.subtract(dj_pos).length < 100){
                $('#myCanvas').remove();
                $('#win').modal('show');

                $('html').bind('keypress', function(e)
                {
                     if(e.keyCode == 13)
                     {
                        $('#win').modal('hide');
                        startAnim();     
                     }
                });
                $('#restart').click(function(){
                    $('#win').modal('hide');
                    startAnim();
                });
            }
              
        }
        
        var dancers = [];
        // Create a dancer in the middle of the page:
        for (var i = 0; i <= 30; i++) {
            dancers.push(new Dancer(new Point( view.bounds.width * Math.random(), view.bounds.height * Math.random()) ).generateRandom().startDance());
        };
        

        
        var dj = new Dancer(dj_pos).generateDJ().startDance();

        dancers.push(dj);
        // Sort it:
        dancers.sort(function(a, b){
            
            return a.z - b.z;
        });

        

        var dancers_group = new Group();

        for (var i =  0; i < dancers.length; i++) {
            dancers_group.addChild(dancers[i]);
            //dancers[i].bringToFront();
        };

        //console.log(dancers_group.exportSVG());
        //$('#ok').html(test.exportSVG());
		
		// draw the stuff (if not, it is drawn when mouse is mouved)
		paper.view.draw();

        // test.move(new Point( view.bounds.width * Math.random(), view.bounds.height * Math.random()));
    }

    $(document).ready(function(){
        $('html').bind('keypress', function(e)
        {
             if(e.keyCode == 13)
             {
                $('#myModal').modal('hide');
                startAnim();     
             }
        });
        $('#start').click(function(){
            $('#myModal').modal('hide');
            startAnim();
        });

        $('#myModal').modal('show');

        paper.setup("max");
        var test = new Dancer(new Point( view.bounds.width/2, view.bounds.height/2), 0.3).generateDJ().startDance();
        
        // Draw paper
        paper.view.draw();
    });



</script>
</head>
<body style="background: black url(img/bg.jpg) repeat -20px -10px; margin: 0; padding:0px;">

    
    <script>document.write('<script src="http://' + (location.host || 'localhost').split(':')[0] + ':35729/livereload.js?snipver=1"></' + 'script>')</script>

    <!-- <svg id="ok"></svg> -->


    <!-- Generator: Adobe Illustrator of some hairs  -->
    <svg style="display:none;" version="1.1" id="cheveux1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
         width="595.28px" height="841.89px" xml:space="preserve">
        <path d="M-0.812,1.892c-1.389-1.345-2.096-4.431-1.375-6.25"/>
        <path d="M2.438,2.017c-0.056-2.394-0.487-4.26,0.125-6.625"/>
        <path d="M6.063,2.142C5.709-0.019,5.272-2.479,6.188-4.483"/>
        <path d="M0.813,0.642c0-1,0-2,0-3"/>
        <path d="M4.063-0.483c-0.349-0.712-0.369-1.392-0.375-2.25"/>
        <path d="M7.063,0.392C7.07-0.6,6.988-1.506,7.688-2.233"/>
        <path d="M-3.312,4.767c-2.217-0.993-4.429-4.94-4.375-7.375"/>
        <path d="M-2.687,2.142c-1.854-0.422-3.048-3.187-2.75-5"/>
        <path d="M1.141,3.55c-1.349-2.537-1.935-5.405-2.232-8.316"/>
    </svg>

    <svg style="display:none;" version="1.1" id="cheveux2" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
         width="595.28px" height="841.89px" xml:space="preserve">
        <path fill="#010101" d="M-13.583,5.949c0,0,0.878-0.129,1.881-2.381c1.498-3.364,3.219-10.915,7.953-8.571
        c6.192,3.065,2.5,5.921,2.5,5.921s-1.154,0.054-3.963,1.791C-5.483,2.877-6,4.116-6,4.116s-0.552-0.615-0.812-0.474
        C-7.268,3.893-7.726,4.127-8.18,4.34C-8.485,4.482-9.25,7.283-9.25,7.283s-0.309-2.367-0.539-2.289
        C-10.618,5.273-12.9,5.965-13.583,5.949z"/>
        <path fill="#010101" d="M1.417-0.959c0,0-4.748-4.673-2.248-5.466s8.58-2.406,11.08,2.983s0.834,5.235,3.334,6.646
            C13.583,3.203,4.75,1.967,1.417-0.959z"/>
    </svg>


    <svg style="display:none;" version="1.1" id="cheveux3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
         width="595.28px" height="841.89px" xml:space="preserve">
        <path d="M3-1.98C2.993-4.426,2.525-7.485,0-8.355"/>
        <path d="M3.125,0c-0.007-2.447-0.475-5.505-3-6.375"/>
        <path d="M3.125-4.417c-0.007-2.446-0.475-4.567-3-5.438"/>
        <path d="M5.846-1.98c0.007-2.446,0.475-5.505,3-6.375"/>
        <path d="M5.721,0C5.728-2.447,7.1-5.505,9.625-6.375"/>
        <path d="M5.721-4.417c0.007-2.446,0.599-5.692,3.124-6.562"/>
        <path d="M4.282-1.156C4.281-3.167,4.119-4.833,3.907-6.781"/>
        <path d="M4.75-4.355c0-1.502-0.475-4.237,0.25-5.5"/>
        <path d="M3.625-7.98C3.544-9.501,3.04-10.769,2-11.73"/>
    </svg>


    <svg style="display:none;" version="1.1" id="cheveux4" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
         width="595.28px" height="841.89px" xml:space="preserve">
        <path fill="none" d="M3.193-7.542C2.739-5.688,2.194-3.75,3.484-2"/>
        <path fill="none" d="M0.234-4.75c0.099,1.393-0.572,2.875,0,4.125"/>
        <path fill="none" d="M1.234-6.125c-1,1.222-0.263,4.717,0.875,5.625"/>
        <path fill="none" d="M4.234-8.625c-1.37,0.691-1.349,4.104,0.25,4.75"/>
        <path fill="none" d="M6.234-9.375c-0.657,0.954-1.427,1.177-1.5,2.634
            C4.689-5.826,4.853-5.215,5.359-4.625"/>
        <path fill="none" d="M6.984-7C6.532-9.308,8.67-9.158,10.109-9.625"/>
        <path fill="none" d="M10.984-9.625c-1.117,0.131-1.919,2.01-1.875,3"/>
        <path fill="none" d="M12.734-7.25c0.448-0.593,0.818-1.199,0.75-2"/>
        <path fill="none" d="M10.484-6.375c-0.023-1.044,1.304-2.202,2-2.875"/>
        <path fill="none" d="M14.234-4.75c-0.096-1.327,0.514-2.564,0.375-3.875"/>
        <path fill="none" d="M15.734-8.125c0,1.794,0.081,3.657-0.625,5.25"/>
        <path fill="none" d="M17.484-6.5c0,1.172,0.641,4.868-1.25,4.875"/>
        <path fill="none" d="M18.734-5c-0.139,1.908,0.367,3.304-0.375,5"/>
    </svg>


     <svg style="display:none;" version="1.1" id="cheveux5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
         width="595.28px" height="841.89px" xml:space="preserve">
        <path fill="none" stroke="#3D4665" stroke-miterlimit="10" d="M-0.375,1.125C-3.547,0.625-5.034-2.288-5.5-5"/>
        <path fill="none" stroke="#3D4665" stroke-miterlimit="10" d="M-0.875,3.5c-2.849,0.161-6.833-1.009-9.275-2.544
            c-1.69-1.062-1.994-1.986-2.6-3.456"/>
        <path fill="none" stroke="#3D4665" stroke-miterlimit="10" d="M0-1.25c-2.078-1.443-2.25-4.095-2.25-6.375"/>
        <path fill="none" stroke="#3D4665" stroke-miterlimit="10" d="M1.125-1.375C1.904-2.05,1.847-3.12,2.5-3.75"/>
        <path fill="none" stroke="#3D4665" stroke-miterlimit="10" d="M-3-2.375c0.362,0.296,0.477,0.816,0.801,1.125
            C-1.58-0.659-0.623-0.441,0,0"/>
        <path fill="none" stroke="#3D4665" stroke-miterlimit="10" d="M3.5-1.5C3.153-2.282,4.268-2.714,4.75-3.125"/>
        <path fill="none" stroke="#3D4665" stroke-miterlimit="10" d="M6-1.125C5.751-1.802,5.833-2.663,6.5-3"/>
        <path fill="none" stroke="#3D4665" stroke-miterlimit="10" d="M-0.625,2.125c-1.02,1.054-5.96,0.144-7.113-1.159
            C-8.22,0.419-8.648-0.957-8.625-1.75"/>
        <path fill="none" stroke="#3D4665" stroke-miterlimit="10" d="M-1.125,3.625c-1.021,1.008-3.559,2.117-4.75,0.75"/>
    </svg>
    


    <div id="myModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
    <h3 id="myModalLabel">O&ugrave; est Max, the DJ?</h3>
  </div>
  <div class="modal-body">
    <div  style="width:500px;">
        <div class="pull-left" style="width:50%;">
            <p>Max s'est perdu dans la foule de sa discoth&egrave;que. Sauras-tu le retrouver?</p>
            <p>Tu dois faire vite, sinon la musique risque de s'arr&ecirc;ter et la f&ecirc;te sera finie!</p>
                <small><em>Max est repr&eacute;sent&eacute; &agrave; droite. Une fois dans la foule, tu dois le localiser. Indique avec ta souris que tu l'as trouv&eacute;.</em></small>
        </div>
        <div class="pull-right" style="width:40%; overflow:hidden;">
            <canvas id="max" width="200" height="200" style="margin-top: -20px;"></canvas>
        </div>
        <div class="clearfix"></div>
    </div>
  </div>
  <div class="modal-footer">
    <!-- <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button> -->
    <button id="start" class="btn btn-primary">Start</button>
  </div>
</div>


<div id="win" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
    <h3>Jeux r&eacute;ussi</h3>
  </div>
  <div class="modal-body">
    <div  style="width:500px;">
        
            <h1>F&eacute;licitation!</h1>
            <p>Tu as trouv&eacute; Max &ndash; the DJ!</p>
    
        <div class="pull-right" style="width:40%; overflow:hidden;">
            <canvas id="max" width="200" height="200" style="margin-top: -20px;"></canvas>
        </div>
        <div class="clearfix"></div>
    </div>
  </div>
  <div class="modal-footer">
    <!-- <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button> -->
    <button id="restart" class="btn btn-primary">Re start</button>
  </div>
</div>


</body>
</html>